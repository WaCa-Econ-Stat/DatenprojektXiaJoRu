---
title: "Datenprojekt1"
author: "R.C. Wallner"
date: "2024-11-22"
output:
  word_document: default
  pdf_document: default
---

```{R,include=FALSE}
library(haven)
library(stargazer)
setwd("C:/Users/walln/OneDrive/Desktop/LMU Ordner/Studiumsunterlagen/econ_WiSe_3/Öko1")
data <- read_dta(file = "Datenprojekt.dta")
dim(data)
View(data)
setwd("C:/Users/walln/OneDrive/Desktop/LMU Ordner/Studiumsunterlagen/stat_WiSe1/GitRepositories/DatenprojektXiaJoRu")
```

```{R, results="asis"}
#Zusammendfassende Statistik

###1

#Zunächst soll ein dataframe erzeugt werden, der jeden Betrieb nur noch einzeln enthält  

df1 <- data.frame(Betrieb = data$ID_betnr,HO = data$bhomeoff)
df2 <- data.frame(Betrieb = 1, HO = 0) 
for(i in 1:nrow(df1)){
  if( ! (  df1[i,1] %in% df2[,1] ) ){
    df2 <- rbind(df2, df1[i,])
  }
}

nrow(df2) == length(unique(df1[,1])) #TRUE heißt alle Betirb-Duplikate eliminert
df2 <- df2[-nrow(df2), ] #Die NA-Betriebe kommen noch 1 mal ganz in der letzten Zeile vor
df2$HO <- factor(df2$HO, levels=c(0,1), labels = c("Nein","Ja"))
Frequency_Table <- prop.table(table(df2$HO))
Share_HO <- as.numeric(Frequency_Table[2])
Share_HO
barplot(Frequency_Table, main="Erlauben Betriebe Home Office?",
        col=c("darkred","darkgreen"), horiz = T)
```


```{R,results="asis"}
###2
#Alle NAs sollen entfernt werden, deswegen wird in jeder Zeile in den jeweiligen Spalten
#geprüft, ob NAs vorhanden sind. Wenn alle Spalten einer Zeile keine NAs enthalten, dann
#wird die Zeile dem neuen dataframe angehangen
#Dieser neue dataframe wird mit der ersten Zeile initialisiert (deswegen beginnt es bei 
#Zeile 2)
df3 <- cbind(df1, Nutzen = data$mheim)[df1$HO==1,]
df4 <- data.frame(Betrieb = 6, HO = 1, Nutzen = 1)
for(i in 2:nrow(df3)){
  enthält <- F
  for(j in 1:3){
    if( is.na(df3[i,j]) ){enthält <- T}
  }
  if( !enthält){
    df4 <- rbind(df4, df3[i,])
  }
}
df4$Nutzen <- factor(df4$Nutzen, levels=c(0,1), labels= c(
  "Nutzt Möglichkeit nicht", "Nutzt Möglichkeit"
))
Frequency_Use <- prop.table(table(df4$Nutzen))
Frequency_Use 
barplot(Frequency_Use, col=c("darkblue", "lightblue"),
        main= "Nutzt der Mitarbeiter die Möglichkeit zum Home Office?")
```
```{R}
###3
#Aus allen 188 Variablen werden die zweckdienlichen (die "mheimnein_" enthalten) 
#herausgesucht
Relevante_Variablen <- character()
for(i in 1:length(colnames(data))){
  if( grepl("mheimnein_", colnames(data)[i] )   ){
    Relevante_Variablen <- c( Relevante_Variablen, colnames(data)[i])
  }
} 
Index <- which(colnames(data)  %in% Relevante_Variablen )
df5 <- na.omit( cbind(df1, data$mheim, data[,Index]) )
nj <- numeric()
for(j in 4:ncol(df5)){
  nj <- c(nj, sum(df5[,j]) )
}
#Abkürzungen für bessere Lesbarkeit
Relevante_Variablen2 <- c("Erl.", "Tech.", "unmö.", "vorg.", "trenn.", "team", "karr.")
Gründe <- data.frame(Relevante_Variablen2, nj)[order(nj), ]
barplot(Gründe$nj, names.arg= Gründe$Relevante_Variablen2,
        col=c(rep("darkblue",2),rep("blue",3),rep("lightblue",2)) ,
        main="Grund für kein Home Office")
```
Die meisten geben einfach nur an, dass es Ihnen *nicht möglich* sei,

der zweit meiste Grund ist, dass die *Vorgesetzten* es nicht gerne sehen. 

```{R,results="asis"}
###4
#Wenn mheimwunsch entweder 1 oder 2 ist, deutet das auf einen Home-Office-Wunsch hin

df6 <- factor(na.omit(subset( data.frame( 
                         wunsch3 = data$mheimwunsch, 
                         HO = data$bhomeoff),
              HO == 0))[,1],levels=1:3, labels = c(rep("Wunsch",2),"Kein Wunsch") )

barplot(table(df6), main = "wünschen sich Arbeitnehmer \n in Betrieben, die kein HO anbieten
        von, zu Hause aus zu arbeiten?",
        col=c("lightblue","darkblue"))
table(df6)
```
```{R}
###5
Wichtige_Variablen <- character()
for(i in 1:ncol(data)){
  if( grepl("mheimwunsch_", colnames(data)[i])){
    Wichtige_Variablen <- c(Wichtige_Variablen, colnames(data)[i])
  }
}
Index2 <- which(colnames(data) %in% Wichtige_Variablen)
df7 <- na.omit(data[, Index2])
Gründe2 <- c("fahren","freiz.","fam","qual.","h_erhöhen")
Häufigkeiten <- apply(df7, 2, sum)
barplot(Häufigkeiten, names.arg=Gründe2,
        col="lightblue")

```











